{% extends 'base.html' %}

{% block title %}Udfordringer{% endblock %}

{% block content %}

    <span class="icon p-5">
        <a href="{{ url_for('challenges.show_event_form') }}">
            <i class="fa-solid fa-calendar-plus fa-2xl has-text-primary"></i>
        </a>
    </span>

    <section class="section" x-data="{ activeTab: 'all_events' }">
        <div class="columns is-centered is-block-tablet">
            <div class="column center is-12">
                <button class="button mr-2" x-on:click="activeTab = 'all_events'"
                x-bind:class="{ 'is-primary': activeTab === 'all_events' }"
                >
                    Find events
                </button>
                <button class="button" x-on:click="activeTab = 'users_events'"
                x-bind:class="{ 'is-primary': activeTab === 'users_events' }"
                >
                    Dine events
                </button>
            </div>
            <div class="column has-text-centered is-12">
                <!--TODO: Lav a tags, url_for og routes som håndterer sortering via følger, seneste etc-->
                <button class="button">
                        Relevante
                </button>
                <button class="button">
                        Følger
                </button>
                <button class="button">
                    Seneste
                </button>
            </div>
        </div>

        <div class="container" x-show="activeTab === 'all_events'">
            <div class="columns is-centered is-block-tablet">
                {% if all_events %}
                    {% for event in all_events %}
                    <div class="box">
                        <div class="column is-flex is-justify-content-space-between">
                            <p class="subtitle is-size-5 mb-0 mr-2 has-text-weight-semibold">
                                {{ event.title }}
                            </p>
                            {% include 'dropdown_event.html' %}
                        </div>
                        <div class="column">
                            <span class="icon-text">
                                <span class="icon">
                                    <i class="fa-solid fa-clock"></i>
                                </span>
                                {{ event.created_formatted }}
                            </span>
                            <span class="icon-text">
                                <span class="icon">
                                    <i class="fa-solid fa-location-dot"></i>
                                </span>
                                {{ event.location }}
                            </span>
                        </div>
                        <div class="column">
                            {{ event.description | truncate(100) }}
                        </div>
                        <div class="column">
                            {% if event.participants%}
                                <span class="icon-text">
                                    <span class="icon">
                                        <i class="fa-solid fa-user-group"></i>
                                    </span>
                                    Deltagere: {{ event.participants }}
                                </span>
                            {% else %}
                                <p>Ingen deltagere</p>
                            {% endif %}
                        </div>
                        <div class="column">
                            <a href="{{ url_for('challenges.view_event', event_id=event.event_id) }}"
                            class="button is-primary">
                                Se mere
                            </a>
                        </div>
                    </div>
                    {% endfor %}
                {% endif %}
            </div>
        </div>

        <div class="container" x-show="activeTab === 'users_events'">
            <div class="columns is-block-tablet">
                {% if users_events %}
                    {% for event in users_events %}
                    <div class="box">
                        <div class="column">
                            <p class="subtitle is-size-5 has-text-weight-semibold">
                                {{ event.title }}
                            </p>
                        </div>
                        <div class="column">
                            <span class="icon-text">
                                <span class="icon">
                                    <i class="fa-solid fa-clock"></i>
                                </span>
                                {{ event.created_formatted }}
                            </span>
                            <span class="icon-text">
                                <span class="icon">
                                    <i class="fa-solid fa-location-dot"></i>
                                </span>
                                {{ event.location }}
                            </span>
                        </div>
                        <div class="column">
                            {{ event.description }}
                        </div>
                        <div class="column">
                            {% if event.participants%}
                                <span class="icon-text">
                                    <span class="icon">
                                        <i class="fa-solid fa-user-group"></i>
                                    </span>
                                    Deltagere: {{ event.participants }}
                                </span>
                            {% else %}
                                <p>Ingen deltagere</p>
                            {% endif %}
                        </div>
                        <div class="column">
                            <a href="{{ url_for('challenges.view_event', event_id=event.event_id) }}"
                            class="button is-primary">
                                Se mere
                            </a>
                        </div>
                    </div>
                    {% endfor %}
                {% endif %}
            </div>
        </div>
    </section>

{% endblock %}